<!DOCTYPE html>
<html style="height:100%;">
  <body style="margin:0; background:black; height:100%;">
    <div id="player" style="width:100%; height:100%;"></div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
    // Variables globales
    var player;
    var playerReady = false;
    
    // Función específica para TLabWebView
    function getUnityPlayerStatus() {
        return {
            ready: playerReady,
            state: player ? player.getPlayerState() : -1,
            time: player ? player.getCurrentTime() : 0,
            duration: player ? player.getDuration() : 0
        };
    }

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            width: '100%',
            height: '100%',
            videoId: 'dQw4w9WgXcQ',
            playerVars: {
                'controls': 0,
                'modestbranding': 1,
                'autoplay': 0,
                'enablejsapi': 1
            },
            events: {
                'onReady': function(event) {
                    console.log("Player ready");
                    playerReady = true;
                    // Notificar a Unity usando el método específico de TLab
                    if (window.unityBridge) {
                        window.unityBridge.notify('OnPlayerReady');
                    }
                },
                'onStateChange': function(event) {
                    console.log("State changed:", event.data);
                },
                'onError': function(event) {
                    console.error("Player error:", event.data);
                }
            }
        });
    }

    // Funciones de control para Unity
    function unityPlayVideo() {
        if (player && player.playVideo) {
            player.playVideo();
            return "Playing";
        }
        return "Player not ready";
    }

    function unityPauseVideo() {
        if (player && player.pauseVideo) {
            player.pauseVideo();
            return "Paused";
        }
        return "Player not ready";
    }

    function unityTogglePlayPause() {
        if (!player) return "Player not ready";
        
        if (player.getPlayerState() === YT.PlayerState.PLAYING) {
            return unityPauseVideo();
        } else {
            return unityPlayVideo();
        }
    }
    </script>
  </body>
</html>
